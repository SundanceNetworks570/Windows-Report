<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Windows Updates & Security Patches — Last 30 Days</title>
<style>
  :root { --bg:#0b1021; --card:#111737; --muted:#8fa3c7; --text:#e9eefc; --accent:#6aa3ff; --accent2:#76e3c7; --chip:#203157; }
  * { box-sizing: border-box; }
  body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif; background: linear-gradient(180deg, var(--bg), #0d1430); color: var(--text); }
  header { position: sticky; top:0; z-index:10; backdrop-filter: blur(10px); background: rgba(13,20,48,.7); border-bottom: 1px solid rgba(255,255,255,.06); }
  .wrap { max-width:1200px; margin:0 auto; padding: 16px 20px; }
  h1 { margin:8px 0 4px; font-size: 26px; letter-spacing: .2px; }
  .sub { color: var(--muted); font-size: 14px; margin-bottom: 12px; }
  .toolbar { display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top: 8px; }
  input[type="search"], select { background: var(--card); border:1px solid rgba(255,255,255,.08); color: var(--text); padding:10px 12px; border-radius: 12px; outline:none; width: min(340px, 100%); }
  .btn { background: linear-gradient(135deg, var(--accent), var(--accent2)); color:#0b1021; border: none; padding: 10px 14px; border-radius: 12px; font-weight: 600; cursor: pointer; }
  .table { width:100%; border-collapse: collapse; margin-top: 14px; }
  .table th, .table td { padding: 14px 12px; vertical-align: top; }
  .table th { position: sticky; top: 82px; z-index: 5; background: #0f1640; text-align: left; font-size: 13px; color: var(--muted); border-bottom: 1px solid rgba(255,255,255,.08); }
  .row { background: rgba(255,255,255,.02); border-bottom: 1px solid rgba(255,255,255,.06); }
  .kb a { color: #a9c7ff; text-decoration: none; font-weight: 600; }
  .badge { display:inline-block; padding:4px 8px; border-radius: 999px; font-size: 12px; color:#cfe8ff; background: var(--chip); margin-right:6px; }
  .small { font-size:12px; color: var(--muted); margin-top:8px; }
  @media print { header, .toolbar, footer { display:none; } .table th { position: static; } body { background:#fff; color:#000; } .row { background:#fff; } a { color:#000; } }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Windows Updates & Security Patches — Last 30 Days</h1>
    <div class="sub">Generated November 07, 2025 20:18 UTC • Newest → oldest</div>
    <div class="toolbar">
      <input id="search" type="search" placeholder="Search (KB, OS, description, issues)…" aria-label="Search updates">
      <select id="osFilter" aria-label="Filter by Operating System">
        <option value="">Filter by Operating System (All)</option>
      </select>
      <button class="btn" onclick="doSearch()">Search</button>
    </div>
  </div>
</header>

<main class="wrap">
  <table class="table" id="updates">
    <thead>
      <tr>
        <th>Date</th>
        <th>KB</th>
        <th>Operating System</th>
        <th>Description</th>
        <th>Known issues</th>
        <th>Type</th>
      </tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>
  <div class="small">Sources: Microsoft Support (KB pages), Microsoft Update Catalog, Windows Release Health.</div>
</main>

<footer class="wrap" style="display:flex; gap:12px; justify-content:flex-end; margin-bottom:40px;">
  <button class="btn" onclick="window.print()">Print to PDF</button>
  <a class="btn" href="mailto:?subject=Windows%20Updates%20Report%20(last%2030%20days)&body=See%20the%20attached%20or%20linked%20report.">Email</a>
</footer>

<script>
const DATA = [];

function typeBadge(t) {
  return `<span class="badge">${t||''}</span>`;
}

function renderOptions(list) {
  const sel = document.getElementById('osFilter');
  const uniq = Array.from(new Set(list)).sort();
  uniq.forEach(os => {
    const opt = document.createElement('option');
    opt.value = os; opt.textContent = os;
    sel.appendChild(opt);
  });
}

function render(data) {
  const tbody = document.getElementById('rows');
  tbody.innerHTML = data.map(d => `
    <tr class="row">
      <td>${new Date(d.date).toLocaleDateString()}</td>
      <td class="kb"><a href="${d.link}" target="_blank" rel="noopener">${d.kb}</a><div class="small">${d.title||''}</div></td>
      <td>${d.os}</td>
      <td>${d.description||''}</td>
      <td>${(d.known_issues||[]).map(i => '<div>• '+i+'</div>').join('')}</td>
      <td>${typeBadge(d.type||'')}</td>
    </tr>
  `).join('');
}

function doSearch() {
  const q = document.getElementById('search').value.trim().toLowerCase();
  const os = document.getElementById('osFilter').value;
  let filtered = DATA;
  if (os) filtered = filtered.filter(d => d.os === os);
  if (q) filtered = filtered.filter(d => (d.kb + ' ' + d.os + ' ' + (d.description||'') + ' ' + (d.known_issues||[]).join(' ')).toLowerCase().includes(q));
  render(filtered);
}

document.getElementById('osFilter').addEventListener('change', doSearch);

render(DATA);
renderOptions(DATA.map(d => d.os));
</script>
</body>
</html>
